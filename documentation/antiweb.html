<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>antiweb &mdash; Finale_sphinx 2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Finale_sphinx 2.1 documentation" href="index.html" />
    <link rel="prev" title="Welcome to Finale_sphinx’s documentation!" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="antiweb">
<h1>antiweb<a class="headerlink" href="#antiweb" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The most important parts of the system are Python 3, Sphinx and antiweb. Because of incompatibility with Python 2 you can&#8217;t create
documentaries of Python 2 programs.</p>
<blockquote>
<div><ul class="simple">
<li>Step 1: Install Python 3.4</li>
<li>Step 2: After installing Python, run below commands in cmd (you have to navigate to Python\Scripts first)</li>
</ul>
<p>The code begins in file antiweb.py at line 2640:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install sphinx
</pre></div>
</div>
<ul class="simple">
<li>IMPORTANT: If you get a connection error the reason is most likely your proxy. You then have to use a tool like &#8220;cntlm&#8221; and add a proxy flag when running pip, example:</li>
</ul>
<p>The code begins in file antiweb.py at line 2646:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install sphinx --proxy http://localhost:8123 //in case you are using cntlm your proxy will be localhost
</pre></div>
</div>
<p>The code begins in file antiweb.py at line 2650:</p>
<div class="highlight-python"><div class="highlight"><pre>pip uninstall babel //uninstall it because of incompatibility
</pre></div>
</div>
<p>The code begins in file antiweb.py at line 2654:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install babel==1.3 //install compatible version
</pre></div>
</div>
<ul>
<li><p class="first">Run sphinx-quickstart.exe and follow the steps to configure sphinx as you like it. (However, say yes to all extensions suggested during the process)</p>
</li>
<li><p class="first">The sphinx quickstart created a project folder for you, open the conf.py which is in that folder</p>
</li>
<li><p class="first">You should find something like this:</p>
<blockquote>
<div><blockquote>
<div><p>The code begins in file antiweb.py at line 2662:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
<span class="s">&#39;sphinx.ext.autodoc&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.doctest&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.intersphinx&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.todo&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.coverage&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.mathjax&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.ifconfig&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.viewcode&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
<p>Add &#8216;sphinx.ext.graphviz&#8217; at the end and it will look like this:</p>
<blockquote>
<div><p>The code begins in file antiweb.py at line 2677:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
<span class="s">&#39;sphinx.ext.autodoc&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.doctest&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.intersphinx&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.todo&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.coverage&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.mathjax&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.ifconfig&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.viewcode&#39;</span><span class="p">,</span>
<span class="s">&#39;sphinx.ext.graphviz&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">Download the Graphviz msi installer from here: <a class="reference external" href="http://www.graphviz.org/Download_windows.php">http://www.graphviz.org/Download_windows.php</a></p>
</li>
<li><p class="first">After installing Graphviz you will find a Graphviz folder inside your Program folder, open it</p>
</li>
<li><p class="first">Copy the content of its bin folder to Python\Scripts</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="preparing-the-rst-files">
<h1>Preparing the .rst files<a class="headerlink" href="#preparing-the-rst-files" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><ul class="simple">
<li>Download antiweb from here <a class="reference external" href="https://github.com/Yarmek/antiweb">https://github.com/Yarmek/antiweb</a> and copy the antiweb.py file into the Python folder</li>
<li>You can now create a .rst file out of a C, C++, C# and py files.</li>
<li>To do that, simply use following command:</li>
</ul>
<p>The code begins in file antiweb.py at line 2703:</p>
<div class="highlight-python"><div class="highlight"><pre>python antiweb.py &quot;PATH TO THE FILE&quot;
</pre></div>
</div>
<ul class="simple">
<li>You will then find a new file which is called &#8220;Filename&#8221;.rst -&gt; This file will be used in Sphinx to generate the documentation</li>
<li>Sphinx also created a index.rst file for you. Open it and add the filename of the rst file (without the file extension) to the toctree so it looks like this:</li>
</ul>
<p>The code begins in file antiweb.py at line 2710:</p>
<div class="highlight-python"><div class="highlight"><pre>.. toctree::
:maxdepth: 2

FILENAME
</pre></div>
</div>
<ul class="simple">
<li>You can add multiple files, they will then be listed in the generated index of your project</li>
<li>It is also possible to use Graphviz for graph visualizatin. A proper graph should look like this:</li>
</ul>
<p>The code begins in file antiweb.py at line 2719:</p>
<div class="highlight-python"><div class="highlight"><pre>.. digraph:: name

 &quot;bubble 1&quot; -&gt; &quot;bubble 2&quot; -&gt; &quot;bubble 3&quot; -&gt; &quot;bubble 1&quot;;
</pre></div>
</div>
<ul class="simple">
<li>The output from above code would look like this:</li>
</ul>
<p class="graphviz">
<img src="_images/graphviz-f54fdecee7af2eda01074702abf16e0cd80fe350.png" alt="digraph test {
&quot;bubble 1&quot; -&gt; &quot;bubble 2&quot; -&gt; &quot;bubble 3&quot; -&gt; &quot;bubble 1&quot;;
}" />
</p>
<ul class="simple">
<li>For more informatin on Graphviz visit <a class="reference external" href="http://www.graphviz.org/">http://www.graphviz.org/</a></li>
<li>When you have included the rst file in the index file, you can run Sphinx to finally create your documentation, here is an example:</li>
</ul>
<p>The code begins in file antiweb.py at line 2733:</p>
<div class="highlight-python"><div class="highlight"><pre>sphinx-build.exe -b html sphinx\source sphinx\source -D graphviz_dot=dot.exe
</pre></div>
</div>
<ul class="simple">
<li>The &#8216;&#8217;-b&#8217;&#8217; flag indicates the builder to use</li>
<li>&#8216;&#8217;sphinx\source&#8217;&#8217; indicates the path to the index.rst</li>
<li>&#8216;&#8217;sphinx\source&#8217;&#8217; this one indicates the output path (you can change your ouput path to every path where you want the final documentation)</li>
<li>&#8216;&#8217;-D graphviz_dot=dot.exe&#8217;&#8217; indicates the path for the graphviz virtualizer dot.exe</li>
<li>After sphinx has finished you will find some .html files in the output path. This is your finished documentation.</li>
</ul>
</div></blockquote>
<div class="section" id="antiweb-documentation">
<h2>Antiweb documentation<a class="headerlink" href="#antiweb-documentation" title="Permalink to this headline">¶</a></h2>
<p>If you just want to generate the documentation from a source file use
the following function:</p>
<dl class="function">
<dt id="generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>fname</em>, <em>tokens</em>, <em>warnings</em><span class="sig-paren">)</span><a class="headerlink" href="#generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a rst file from a source file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fname</strong> (<em>string</em>) &#8211; The path to the source file.</li>
<li><strong>tokens</strong> (<em>list</em>) &#8211; A list of string tokens, used for &#64;if directives.</li>
<li><strong>show_warnings</strong> (<em>bool</em>) &#8211; Warnings will be written
via the logging module.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2465:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">show_warnings</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;file not found: </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">lexer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_lexer_for_filename</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Reader</span><span class="p">)(</span><span class="n">lexer</span><span class="p">)</span>

    <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">show_warnings</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="objects">
<h2>Objects<a class="headerlink" href="#objects" title="Permalink to this headline">¶</a></h2>
<div class="compound">
<p>The graph below show the main objects of antiweb:</p>
</div>
<p>The graph below show the main objects of antiweb:</p>
<blockquote>
<div><p class="graphviz">
<img src="_images/graphviz-044ef63b69cde09bb36b33a7bd75a02bbcf59545.png" alt="digraph collaboration {
Dokument [shape=box, label=&quot;Dokument&quot;]
Reader   [shape=box, label=&quot;Reader&quot;]
directives [shape=box, label=&quot;Directive&quot; ]
Bloecke [shape=box]
Linien [shape=box]

Dokument -&gt; Reader [label=&quot;benutzt&quot;]
Reader -&gt; directives [label=&quot;erstellt&quot;]
Dokument -&gt; directives [label=&quot;benutzt&quot;]
Dokument -&gt; Bloecke [label=&quot;beinhaltet&quot;]
directives -&gt; Bloecke [label=&quot;verarbeitet&quot;]
Bloecke -&gt; Linien [label=&quot;beinhaltet&quot;]
Linien -&gt; directives [label=&quot;beinhaltet&quot;]
}" />
</p>
<p>The <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">document</span></code></a> manages the complete transformation: It uses a
<a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">reader</span></code></a>  to parse source code. The <a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">reader</span></code></a>
creates <a class="reference internal" href="#directives"><span>directives</span></a> objects for each found antiweb directive in the source
code. The source code is split in text blocks which consists of several
<a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">lines</span></code></a>. The <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">document</span></code></a> process all
<a class="reference internal" href="#directives"><span>directives</span></a>  to generate the output document.</p>
<p class="graphviz">
<img src="_images/graphviz-fe45e70a73582ba77b360ffbb325fa480309ab41.png" alt="digraph foo {
&quot;Nummer 1&quot; -&gt; &quot;Nummer 2&quot; -&gt; &quot;Nummer 3&quot; -&gt; &quot;Nummer 1&quot;;
}" />
</p>
</div></blockquote>
</div>
<div class="section" id="directives">
<span id="id1"></span><h2>Directives<a class="headerlink" href="#directives" title="Permalink to this headline">¶</a></h2>
<div class="section" id="directive">
<h3>Directive<a class="headerlink" href="#directive" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Directive">
<em class="property">class </em><code class="descname">Directive</code><span class="sig-paren">(</span><em>line</em><span class="optional">[</span>, <em>mo</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Directive" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class of all directives.
Directives can be distinguished by the different tasks,
they handle, these Task are generally:</p>
<blockquote>
<div><ul class="simple">
<li>identifying a text block (<a class="reference internal" href="#Directive.collect_block" title="Directive.collect_block"><code class="xref py py-meth docutils literal"><span class="pre">collect_block()</span></code></a>)</li>
<li>inserting text in the output (<a class="reference internal" href="#Directive.process" title="Directive.process"><code class="xref py py-meth docutils literal"><span class="pre">process()</span></code></a>)</li>
<li>modifying text in the output (<a class="reference internal" href="#Directive.process" title="Directive.process"><code class="xref py py-meth docutils literal"><span class="pre">process()</span></code></a>)</li>
<li>deleting text in the output (<a class="reference internal" href="#Directive.process" title="Directive.process"><code class="xref py py-meth docutils literal"><span class="pre">process()</span></code></a>)</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line</strong> &#8211; the line number the directive was found</li>
<li><strong>mo</strong> &#8211; a match object of an regular expression</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 320:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre>class Directive(object):
    #Attributes
    &lt;&lt;Directive.expression&gt;&gt;
    &lt;&lt;Directive.priority&gt;&gt;
    &lt;&lt;Directive.line&gt;&gt;

    #Methods
    &lt;&lt;Directive.__init__&gt;&gt;
    &lt;&lt;Directive.collect_block&gt;&gt;
    &lt;&lt;Directive.process&gt;&gt;
    &lt;&lt;Directive.match&gt;&gt;
    &lt;&lt;Directive.__repr__&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="attribute">
<dt id="Directive.expression">
<code class="descname">expression</code><a class="headerlink" href="#Directive.expression" title="Permalink to this definition">¶</a></dt>
<dd><p>A regular expression defining the directive.</p>
<p>The code begins in file antiweb.py at line 357:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">expression</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Directive.priority">
<code class="descname">priority</code><a class="headerlink" href="#Directive.priority" title="Permalink to this definition">¶</a></dt>
<dd><p>An integer process priority. Directives with a lower priority
will be processed earlier.</p>
<p>The code begins in file antiweb.py at line 364:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">priority</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Directive.line">
<code class="descname">line</code><a class="headerlink" href="#Directive.line" title="Permalink to this definition">¶</a></dt>
<dd><p>A integer defining the original line number of the directive.</p>
<p>The code begins in file antiweb.py at line 372:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">line</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Directive.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>line</em><span class="optional">[</span>, <em>mo</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Directive.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor</p>
<p>The code begins in file antiweb.py at line 382:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Directive.collect_block">
<code class="descname">collect_block</code><span class="sig-paren">(</span><em>document</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#Directive.collect_block" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called by <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>.
If the directive is defining a text block. It
retrieves the text lines of the block from the document
and return them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>document</strong> (<a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>) &#8211; the document calling the function.</li>
<li><strong>index</strong> (<em>integer</em>) &#8211; the line index of the directive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">If the directive collects a block the return value
is a tuple <code class="docutils literal"><span class="pre">(directive</span> <span class="pre">name,</span> <span class="pre">block</span> <span class="pre">of</span> <span class="pre">lines)</span></code>, or
<code class="docutils literal"><span class="pre">None</span></code> otherwise.</p>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 392:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">collect_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Directive.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>document</em>, <em>block</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#Directive.process" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called by <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>.
The directive should do whatever it is supposed to do.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>document</strong> (<a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>) &#8211; the document calling the function.</li>
<li><strong>block</strong> &#8211; The line block the directive is in.</li>
<li><strong>index</strong> (<em>integer</em>) &#8211; the line index of the directive
within the block.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 413:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Directive.match">
<code class="descname">match</code><span class="sig-paren">(</span><em>lines</em><span class="sig-paren">)</span><a class="headerlink" href="#Directive.match" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called by <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>.
It gives the directive the chance to find and manipulate other
directives.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lines</strong> (<em>list</em>) &#8211; a list of all document lines.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 430:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Directive.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Directive.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a textual representation of the directive.</p>
<p>The code begins in file antiweb.py at line 444:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;&lt;</span><span class="si">%s</span><span class="s"> at </span><span class="si">%i</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="namedirective">
<h3>NameDirective<a class="headerlink" href="#namedirective" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="NameDirective">
<em class="property">class </em><code class="descname">NameDirective</code><span class="sig-paren">(</span><em>line</em>, <em>mo</em><span class="sig-paren">)</span><a class="headerlink" href="#NameDirective" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for directives with a name argument.
It inherits <a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line</strong> &#8211; the line number the directive was found</li>
<li><strong>mo</strong> &#8211; a match object of an regular expression or
a string defining the name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="NameDirective.name">
<code class="descname">name</code><a class="headerlink" href="#NameDirective.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A string defining the argument of the directive.</p>
</dd></dl>

<p>The code begins in file antiweb.py at line 455:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">NameDirective</span><span class="p">(</span><span class="n">Directive</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mo</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">mo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;&lt;</span><span class="si">%s</span><span class="s">(</span><span class="si">%s</span><span class="s">) </span><span class="si">%i</span><span class="s">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="start">
<h3>Start<a class="headerlink" href="#start" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Start">
<em class="property">class </em><code class="descname">Start</code><a class="headerlink" href="#Start" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a <code class="docutils literal"><span class="pre">&#64;start</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;start</span></code> directive defines the beginning of
a text block. It is called with an argument defining
the name of the text block. There are two special text
blocks:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">()</span></code> The empty one defining the main text block</li>
<li><code class="docutils literal"><span class="pre">(__macro__)</span></code> defining a text block for implementing macros.</li>
</ul>
</div></blockquote>
<p>There are several possibilities to end a text block.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The end of the file</li>
<li>A line with a smaller indentation as the <code class="docutils literal"><span class="pre">&#64;start</span></code> directive.</li>
<li>Another start directive with same indentation.</li>
<li>An unnamed end (<code class="docutils literal"><span class="pre">&#64;</span></code>) directive with the same indentation as
the <code class="docutils literal"><span class="pre">&#64;start</span></code> directive.</li>
<li>A named end directive closing this block or an outer block.</li>
</ol>
</div></blockquote>
<p>Text blocks defined by <code class="docutils literal"><span class="pre">&#64;start</span></code> can be nested.</p>
<p>The code begins in file antiweb.py at line 490:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre>class Start(NameDirective):
    #Attributes
    &lt;&lt;Start.has_named_end&gt;&gt;
    &lt;&lt;Start.inherited attributes&gt;&gt;

    #Methods
    &lt;&lt;Start._find_matching_end&gt;&gt;
    &lt;&lt;Start.collect_block&gt;&gt;
    &lt;&lt;Start.process&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="attribute">
<dt id="Start.has_named_end">
<code class="descname">has_named_end</code><a class="headerlink" href="#Start.has_named_end" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean value, signalizing if the directive is
ended by a named end directive.</p>
<p>The code begins in file antiweb.py at line 539:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">has_named_end</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</dd></dl>

<p id="start-inherited-attributes"><strong>&lt;&lt;Start.inherited attributes&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 547:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@start\((.*)\)&quot;</span><span class="p">)</span>
<span class="n">priority</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<dl class="method">
<dt id="Start.collect_block">
<code class="descname">collect_block</code><span class="sig-paren">(</span><em>document</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#Start.collect_block" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Directive.collect_block" title="Directive.collect_block"><code class="xref py py-meth docutils literal"><span class="pre">Directive.collect_block()</span></code></a>.
The returned lines are unindented to column 0.</p>
<p>The code begins in file antiweb.py at line 602:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">collect_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_matching_end</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="p">:])</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="n">end</span><span class="p">]</span>

    <span class="n">reduce_block</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">block</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reduce_block</span><span class="p">:</span>
        <span class="n">document</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s">&quot;Empty &#39;</span><span class="si">%s</span><span class="s">&#39; block&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c">#unindent the block, empty lines may not count (filter(bool, block))</span>
    <span class="n">indent_getter</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&quot;indent&quot;</span><span class="p">)</span>
    <span class="n">min_indent</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">indent_getter</span><span class="p">,</span> <span class="n">reduce_block</span><span class="p">)))</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="o">-</span><span class="n">min_indent</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">block</span> <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">block</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Start.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>document</em>, <em>block</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#Start.process" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Directive.process" title="Directive.process"><code class="xref py py-meth docutils literal"><span class="pre">Directive.process()</span></code></a>.
Removes all lines of the text block from
the containing block.</p>
<p>The code begins in file antiweb.py at line 625:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_matching_end</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:])</span>
    <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="n">end</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Start._find_matching_end">
<code class="descname">_find_matching_end</code><span class="sig-paren">(</span><em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#Start._find_matching_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the matching end for the text block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> (<em>list</em>) &#8211; A list of lines beginning with start</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The line index of the found end.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 553:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_find_matching_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_named_end</span><span class="p">:</span>
        <span class="c"># ignore all other ending conditions and directly</span>
        <span class="c"># find the matching end directive</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">directive</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">End</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">j</span>

    <span class="n">start_indent</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">indent</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">lindent</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">indent</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">directive</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">End</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">lindent</span> <span class="o">==</span> <span class="n">start_indent</span><span class="p">:</span>
                <span class="c">#case 4: An unnamed @ directive with the same indentation</span>
                <span class="c">#        as the @start directive.</span>
                <span class="k">return</span> <span class="n">j</span>

            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">start_line</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">:</span>
                <span class="c">#case 5: A named @ directive closing this block</span>
                <span class="c">#        or an outer block.</span>
                <span class="k">return</span> <span class="n">j</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Start</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lindent</span> <span class="o">==</span> <span class="n">start_indent</span><span class="p">:</span>
            <span class="c">#case 3: Another @start directive with same indentation.</span>
            <span class="k">return</span> <span class="n">j</span>

        <span class="k">if</span> <span class="n">lindent</span> <span class="o">&lt;</span> <span class="n">start_indent</span> <span class="ow">and</span> <span class="n">l</span><span class="p">:</span>
            <span class="c">#case 2: A line with a smaller indentation as the @start directive.</span>
            <span class="c">#        (an empty line doesn&#39;t count)</span>
            <span class="k">return</span> <span class="n">j</span>

    <span class="c">#case 1: The end of the file</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="rstart">
<h3>RStart<a class="headerlink" href="#rstart" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="RStart">
<em class="property">class </em><code class="descname">RStart</code><a class="headerlink" href="#RStart" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a <code class="docutils literal"><span class="pre">&#64;rstart</span></code> directive. It inherits
<a class="reference internal" href="#Start" title="Start"><code class="xref py py-class docutils literal"><span class="pre">Start</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;rstart</span></code> directive works like the <code class="docutils literal"><span class="pre">&#64;start</span></code>
directive. While <code class="docutils literal"><span class="pre">&#64;start</span></code> removes it&#8217;s block completely
from the containing block. <code class="docutils literal"><span class="pre">&#64;rstart</span></code> replaces the lines
with a <code class="docutils literal"><span class="pre">&lt;&lt;name&gt;&gt;</span></code> - Sentinel.</p>
<p>The code begins in file antiweb.py at line 638:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RStart</span><span class="p">(</span><span class="n">Start</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@rstart\((.*)\)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_matching_end</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:])</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">line</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&lt;&lt;</span><span class="si">%s</span><span class="s">&gt;&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="cstart">
<h3>CStart<a class="headerlink" href="#cstart" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="CStart">
<em class="property">class </em><code class="descname">CStart</code><a class="headerlink" href="#CStart" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a <code class="docutils literal"><span class="pre">&#64;rstart</span></code> directive. It inherits
<a class="reference internal" href="#RStart" title="RStart"><code class="xref py py-class docutils literal"><span class="pre">RStart</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;cstart(name)</span></code> directive is a replacement for</p>
<div class="highlight-python"><div class="highlight"><pre>@rstart(name)
@code
</pre></div>
</div>
<p>The code begins in file antiweb.py at line 670:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CStart</span><span class="p">(</span><span class="n">RStart</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@cstart\((.*)\)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">collect_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">name_block</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CStart</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">collect_block</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name_block</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>

        <span class="n">name</span><span class="p">,</span> <span class="n">block</span> <span class="o">=</span> <span class="n">name_block</span>

        <span class="n">first</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Code</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">block</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">first</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;@code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">directives</span><span class="o">=</span><span class="n">sd</span><span class="p">,</span>
                                                <span class="n">index</span><span class="o">=</span><span class="n">first</span><span class="o">.</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">block</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="end">
<h3>End<a class="headerlink" href="#end" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="End">
<em class="property">class </em><code class="descname">End</code><a class="headerlink" href="#End" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an end directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The end (<code class="docutils literal"><span class="pre">&#64;</span></code>) directive ends a text block.</p>
<p>The code begins in file antiweb.py at line 712:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">End</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@(\((.*)\))?\s*$&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mo</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">mo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span>

        <span class="c">#find the matching start and inform it for the named end</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Start</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">has_named_end</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">line</span>
                    <span class="k">return</span>


    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="c">#completely remove the directive from the containing block</span>
        <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="include">
<h3>Include<a class="headerlink" href="#include" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Include">
<em class="property">class </em><code class="descname">Include</code><a class="headerlink" href="#Include" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;include</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;include</span></code> directive inserts the contents of the
text block with the same name. The lines have the same
indentation as the <code class="docutils literal"><span class="pre">&#64;include</span></code> directive.</p>
<p>The directive can have a second <em>file</em> argument. If given
the directive inserts the text block of the specified file.</p>
<p>The code begins in file antiweb.py at line 974:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Include</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@include\((.+)\)&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="c">#check if the name contains 2 arguments</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">document</span><span class="o">.</span><span class="n">blocks_included</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="c">#a file name is given, fetch block from that file</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">subdoc</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">get_subdoc</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subdoc</span><span class="p">:</span>
                <span class="n">include</span> <span class="o">=</span> <span class="n">subdoc</span><span class="o">.</span><span class="n">get_compiled_block</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">include</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">include</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">get_compiled_block</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">include</span><span class="p">:</span>
            <span class="c">#print &quot;error include&quot;, self.line, name</span>
            <span class="n">document</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span>
                               <span class="s">&quot;Cannot find text block: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c">#replace the directive with its content</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">indent</span>
        <span class="n">include</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">include</span> <span class="p">]</span>
        <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">include</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="rinclude">
<h3>RInclude<a class="headerlink" href="#rinclude" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="RInclude">
<em class="property">class </em><code class="descname">RInclude</code><a class="headerlink" href="#RInclude" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;rinclude</span></code> directive. It inherits
<a class="reference internal" href="#Include" title="Include"><code class="xref py py-class docutils literal"><span class="pre">Include</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;rinclude(text</span> <span class="pre">block</span> <span class="pre">name)</span></code> directive is a is a replacement for:</p>
<div class="highlight-python"><div class="highlight"><pre>.. _text block name:

**&lt;&lt;text block name&gt;&gt;**

@include(text block name)
</pre></div>
</div>
<p>The code begins in file antiweb.py at line 1034:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RInclude</span><span class="p">(</span><span class="n">Include</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@rinclude\((.+)\)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RInclude</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">),</span>
                               <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;.. _</span><span class="si">%s</span><span class="s">:&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                               <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">),</span>
                               <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;**&lt;&lt;</span><span class="si">%s</span><span class="s">&gt;&gt;**&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                               <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="code">
<h3>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Code">
<em class="property">class </em><code class="descname">Code</code><a class="headerlink" href="#Code" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;code</span></code> directive. It inherits
<a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;code</span></code> directive starts a code block. All
lines following <code class="docutils literal"><span class="pre">&#64;code</span></code> will be displayed as source code.</p>
<dl class="docutils">
<dt>A <code class="docutils literal"><span class="pre">&#64;code</span></code> directive ends,</dt>
<dd><ul class="first last simple">
<li>if the text block ends</li>
<li>if an <code class="docutils literal"><span class="pre">&#64;edoc</span></code> occurs.</li>
</ul>
</dd>
</dl>
<p>The content of the special macro <code class="docutils literal"><span class="pre">__codeprefix__</span></code> is inserted
before each code block. <code class="docutils literal"><span class="pre">__codeprefix__</span></code> is empty by default
and can be defined by a <code class="docutils literal"><span class="pre">&#64;define</span></code> directive.</p>
<p>The code begins in file antiweb.py at line 1102:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Code</span><span class="p">(</span><span class="n">Directive</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@code&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="c">#change the indentation the code lines</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)):</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">directive</span><span class="p">,</span> <span class="n">Edoc</span><span class="p">):</span>
                <span class="k">break</span>

            <span class="n">block</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span>

        <span class="c">#insert the rst prefix</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="p">[</span><span class="n">Subst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s">&quot;__codeprefix__&quot;</span><span class="p">)]</span>
        <span class="n">new_block</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">line</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;@subst(__codeprefix__)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">directives</span><span class="o">=</span><span class="n">sd</span><span class="p">),</span>
            <span class="n">line</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;::&quot;</span><span class="p">),</span>
            <span class="n">line</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_block</span>
        <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="edoc">
<h3>Edoc<a class="headerlink" href="#edoc" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Edoc">
<em class="property">class </em><code class="descname">Edoc</code><a class="headerlink" href="#Edoc" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;edoc</span></code> directive. It inherits
<a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;edoc</span></code> directive ends a previously started <code class="docutils literal"><span class="pre">&#64;code</span></code> directive</p>
<p>The code begins in file antiweb.py at line 1075:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Edoc</span><span class="p">(</span><span class="n">Directive</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@edoc&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="if">
<h3>If<a class="headerlink" href="#if" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="If">
<em class="property">class </em><code class="descname">If</code><a class="headerlink" href="#If" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;if</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;if</span></code> directive is used for conditional weaving.
The content of an <code class="docutils literal"><span class="pre">&#64;if</span></code>, <code class="docutils literal"><span class="pre">&#64;fi</span></code> block is waved if the
named token argument of <code class="docutils literal"><span class="pre">&#64;if</span></code>, is defined in the command line
by the <code class="docutils literal"><span class="pre">--token</span></code> option.</p>
<p>The code begins in file antiweb.py at line 789:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">If</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@if\((.+)\)&quot;</span><span class="p">)</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">directive</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Fi</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">document</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s">&quot;No fi for if </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="fi">
<h3>Fi<a class="headerlink" href="#fi" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Fi">
<em class="property">class </em><code class="descname">Fi</code><a class="headerlink" href="#Fi" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a <cite>&#64;fi</cite> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;fi</span></code> ends an <code class="docutils literal"><span class="pre">&#64;if</span></code> directive</p>
<p>The code begins in file antiweb.py at line 762:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Fi</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@fi\((.+)\)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="ignore">
<h3>Ignore<a class="headerlink" href="#ignore" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Ignore">
<em class="property">class </em><code class="descname">Ignore</code><a class="headerlink" href="#Ignore" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;ignore</span></code> directive. It inherits
<a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;ignore</span></code> directive ignores the line in the
documentation output. It can be used for commentaries.</p>
<p>The code begins in file antiweb.py at line 1159:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Ignore</span><span class="p">(</span><span class="n">Directive</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;@ignore&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="define">
<h3>Define<a class="headerlink" href="#define" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Define">
<em class="property">class </em><code class="descname">Define</code><a class="headerlink" href="#Define" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;define</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;define</span></code> directive defines a macro, that can be used
with a <code class="docutils literal"><span class="pre">&#64;subst</span></code> directive. If a <code class="docutils literal"><span class="pre">substitution</span></code>
argument is given, the macro defines an inline substitution.
Otherwise the <code class="docutils literal"><span class="pre">&#64;define</span></code> has to be ended by an <code class="docutils literal"><span class="pre">&#64;enifed</span></code>
directive.</p>
<p>The code begins in file antiweb.py at line 834:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Define</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>

    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@define\((.+)\)&quot;</span><span class="p">)</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="c">#more than one argument ==&gt; an inline substitution</span>
            <span class="n">document</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c">#search for the matching @enifed</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">directive</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Enifed</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">document</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s">&quot;No enifed for define </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">document</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="enifed">
<h3>Enifed<a class="headerlink" href="#enifed" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Enifed">
<em class="property">class </em><code class="descname">Enifed</code><a class="headerlink" href="#Enifed" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;enifed</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;enifed</span></code> directive ends a macro defined by the
<code class="docutils literal"><span class="pre">&#64;define</span></code> directive.</p>
<p>The code begins in file antiweb.py at line 884:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Enifed</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>

    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@enifed\((.+)\)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="subst">
<h3>Subst<a class="headerlink" href="#subst" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Subst">
<em class="property">class </em><code class="descname">Subst</code><a class="headerlink" href="#Subst" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a <code class="docutils literal"><span class="pre">&#64;subst</span></code> directive. It inherits
<a class="reference internal" href="#NameDirective" title="NameDirective"><code class="xref py py-class docutils literal"><span class="pre">NameDirective</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;subst</span></code> directive is replaced by the substitution,
defined by a <code class="docutils literal"><span class="pre">&#64;define</span></code> directive. There are two predefined
macros:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__line__</span></code></dt>
<dd>Define the current line within the source code. The
<code class="docutils literal"><span class="pre">&#64;subst</span></code> can also handle operation with <code class="docutils literal"><span class="pre">__line__</span></code>
like <code class="docutils literal"><span class="pre">__line__</span> <span class="pre">+</span> <span class="pre">2</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">__file__</span></code></dt>
<dd>Defines the current source file name.</dd>
</dl>
</div></blockquote>
<p>The code begins in file antiweb.py at line 912:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Subst</span><span class="p">(</span><span class="n">NameDirective</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&quot;@subst\((.+?)\)&quot;</span><span class="p">)</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="c">#find the substitution</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;__line__&quot;</span><span class="p">):</span>
            <span class="n">expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;__line__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">subst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">document</span><span class="o">.</span><span class="n">macros</span><span class="p">:</span>
            <span class="n">document</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="s">&quot;No macro </span><span class="si">%s</span><span class="s"> found&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">subst</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subst</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c">#inline substitution</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">l</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;@subst(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
            <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">index</span>
            <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>\
                                         <span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>\
                                         <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ln</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
                                     <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subst</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="indent">
<h3>Indent<a class="headerlink" href="#indent" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Indent">
<em class="property">class </em><code class="descname">Indent</code><a class="headerlink" href="#Indent" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an <code class="docutils literal"><span class="pre">&#64;indent</span></code> directive. It inherits
<a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a>.</p>
<p>The <code class="docutils literal"><span class="pre">&#64;indent</span></code> directive changes the indentation of the
following lines. For example a  call <code class="docutils literal"><span class="pre">&#64;indent</span> <span class="pre">-4</span></code>
dedents the following lines by 4 spaces.</p>
<p>The code begins in file antiweb.py at line 1187:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Indent</span><span class="p">(</span><span class="n">Directive</span><span class="p">):</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;@indent\s+([+-]?\d+)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Indent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">mo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
        <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lines</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
</div>
<div class="section" id="readers">
<h2>Readers<a class="headerlink" href="#readers" title="Permalink to this headline">¶</a></h2>
<p>Readers are responsible for the language dependent
source parsing.</p>
<div class="section" id="reader">
<h3>Reader<a class="headerlink" href="#reader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Reader">
<em class="property">class </em><code class="descname">Reader</code><span class="sig-paren">(</span><em>lexer</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the base class for all readers. The public functions
exposed to <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a> are <a class="reference internal" href="#Reader.process" title="Reader.process"><code class="xref py py-meth docutils literal"><span class="pre">process()</span></code></a>,
and <a class="reference internal" href="#filter_output" title="filter_output"><code class="xref py py-meth docutils literal"><span class="pre">filter_output()</span></code></a>.</p>
<p>The main tasks for a reader is:</p>
<blockquote>
<div><ul class="simple">
<li>Recognize lines that can contain directives. (comment lines or doc strings).</li>
<li>Modify the source for language specific optimizations.</li>
<li>Filter the processed output.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lexer</strong> &#8211; A pygments lexer for the specified language</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1253:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre>re_line_start = re.compile(&quot;^&quot;, re.M) #to find the line start indices

class Reader(object):
    #Public Methods
    &lt;&lt;Reader.__init__&gt;&gt;
    &lt;&lt;Reader.process&gt;&gt;
    &lt;&lt;Reader.filter_output&gt;&gt;

    #Protected Methods
    &lt;&lt;Reader._accept_token&gt;&gt;
    &lt;&lt;Reader._post_process&gt;&gt;
    &lt;&lt;Reader._handle_token&gt;&gt;
    &lt;&lt;Reader._cut_comment&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="method">
<dt id="Reader.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>lexer</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor</p>
<p>The code begins in file antiweb.py at line 1288:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lexer</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lexer</span> <span class="o">=</span> <span class="n">lexer</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Reader.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>fname</em>, <em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the source code and identifies the directives.
This method is call by <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> (<em>string</em>) &#8211; The file name of the source code</li>
<li><strong>text</strong> (<em>string</em>) &#8211; The source code</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> objects.</p>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1298:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">starts</span> <span class="o">=</span> <span class="p">[</span> <span class="n">mo</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">re_line_start</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="p">]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Line</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span> <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>    <span class="c"># A list of lines</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">starts</span> <span class="o">=</span> <span class="n">starts</span>  <span class="c"># the start indices of the lines</span>

    <span class="n">tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">get_tokens_unprocessed</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_token</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_post_process</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Reader.filter_output">
<code class="descname">filter_output</code><span class="sig-paren">(</span><em>lines</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader.filter_output" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is call by <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a> and gives
the reader the chance to influence the final output.</p>
<p>The code begins in file antiweb.py at line 1325:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">filter_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lines</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Reader._handle_token">
<code class="descname">_handle_token</code><span class="sig-paren">(</span><em>index</em>, <em>token</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader._handle_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Find antiweb directives in valid pygments tokens.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>index</strong> (<em>integer</em>) &#8211; The index within the source code</li>
<li><strong>token</strong> &#8211; A pygments token.</li>
<li><strong>value</strong> (<em>string</em>) &#8211; The token value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1373:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_handle_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accept_token</span><span class="p">(</span><span class="n">token</span><span class="p">):</span> <span class="k">return</span>

    <span class="n">cvalue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cut_comment</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cvalue</span><span class="p">)</span>
    <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">directives</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">cvalue</span><span class="p">):</span>
            <span class="n">li</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starts</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="n">mo</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">li</span><span class="p">]</span>
            <span class="n">line</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">directives</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span> <span class="n">v</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">mo</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Reader._cut_comment">
<code class="descname">_cut_comment</code><span class="sig-paren">(</span><em>index</em>, <em>token</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader._cut_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Cuts of the comment identifiers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>index</strong> (<em>integer</em>) &#8211; The index within the source code</li>
<li><strong>token</strong> &#8211; A pygments token.</li>
<li><strong>value</strong> (<em>string</em>) &#8211; The token value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value without comment identifiers.</p>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1397:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_cut_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">text</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Reader._post_process">
<code class="descname">_post_process</code><span class="sig-paren">(</span><em>fname</em>, <em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader._post_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Does some post processing after the directives where found.</p>
<p>The code begins in file antiweb.py at line 1353:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_post_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>

    <span class="c">#correct the line attribute of directives, in case there have</span>
    <span class="c">#been lines inserted or deleted by subclasses of Reader</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">i</span>

    <span class="c">#give the directives the chance to match</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Reader._accept_token">
<code class="descname">_accept_token</code><span class="sig-paren">(</span><em>token</em><span class="sig-paren">)</span><a class="headerlink" href="#Reader._accept_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the token type may contain a directive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>token</strong> &#8211; A pygments token</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">True</span></code> if the token may contain a directive.
<code class="docutils literal"><span class="pre">False</span></code> otherwise.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1339:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_accept_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="creader">
<h3>CReader<a class="headerlink" href="#creader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="CReader">
<em class="property">class </em><code class="descname">CReader</code><a class="headerlink" href="#CReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A reader for C/C++ code. This class inherits <a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a>.</p>
<p>The code begins in file antiweb.py at line 1412:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CReader</span><span class="p">(</span><span class="n">Reader</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_accept_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">Token</span><span class="o">.</span><span class="n">Comment</span>

    <span class="k">def</span> <span class="nf">_cut_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;/*&quot;</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;//&quot;</span><span class="p">):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">text</span>

    <span class="k">def</span> <span class="nf">filter_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. py:method:: filter_output(lines)</span>

<span class="sd">           See :py:meth:`Reader.filter_output`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s">&quot;d&quot;</span><span class="p">:</span>
                <span class="c">#remove comment chars in document lines</span>
                <span class="n">stext</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">stext</span> <span class="o">==</span> <span class="s">&#39;/*&#39;</span> <span class="ow">or</span> <span class="n">stext</span> <span class="o">==</span> <span class="s">&quot;*/&quot;</span><span class="p">:</span>
                    <span class="c">#remove &quot;&quot;&quot; and &#39;&#39;&#39; from documentation lines</span>
                    <span class="c">#see the l.text.lstrip()! if the lines ends with a white space</span>
                    <span class="c">#the quotes will be kept! This is feature, to force the quotes</span>
                    <span class="c">#in the output</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">stext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;//&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">stext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;#####&quot;</span><span class="p">):</span>
                    <span class="c">#remove comments but not chapters</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">indented</span><span class="p">(</span><span class="n">stext</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

            <span class="k">yield</span> <span class="n">l</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div>
<div class="section" id="pythonreader">
<h3>PythonReader<a class="headerlink" href="#pythonreader" title="Permalink to this headline">¶</a></h3>
<p>&#8216;&#8217;&#8217;
.. py:class:: PythonReader</p>
<blockquote>
<div><p>A reader for python code. This class inherits <a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a>.
To reduce the number of sentinels, the python reader does some more
sophisticated source parsing:</p>
<p>A construction like:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="nd">@cstart</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Foo&#39;s documentation</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">code</span>
</pre></div>
</td></tr></table></div>
<p>is replaced by:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre>@cstart(foo)
def foo(arg1, arg2):
   @start(foo doc)
   &quot;&quot;&quot;
   Foo&#39;s documentation
   &quot;&quot;&quot;
   @include(foo)
   @(foo doc)
   code
</pre></div>
</td></tr></table></div>
<p>The replacement will be done only:</p>
<blockquote>
<div><ul class="simple">
<li>If the doc string begins with &#8220;&#8221;&#8220;</li>
<li>If the block was started by a <code class="docutils literal"><span class="pre">&#64;rstart</span></code> or <code class="docutils literal"><span class="pre">&#64;cstart</span></code> directive</li>
<li>If there is no antiweb directive in the doc string.</li>
<li>Only a <code class="docutils literal"><span class="pre">&#64;cstart</span></code> will insert the &#64;include directive.</li>
</ul>
</div></blockquote>
<p>Additionally the python reader removes all single line <code class="docutils literal"><span class="pre">&quot;&quot;&quot;</span></code> and <code class="docutils literal"><span class="pre">'''</span></code>
from documentation lines. In the following lines:</p>
<div class="highlight-python"><div class="highlight"><pre>@start(foo)
&quot;&quot;&quot;
Documentation
&quot;&quot;&quot;
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">&quot;&quot;&quot;</span></code> are automatically removed in the rst output. (see <a class="reference internal" href="#filter_output" title="filter_output"><code class="xref py py-meth docutils literal"><span class="pre">filter_output()</span></code></a>
for details).</p>
</div></blockquote>
<p>&#8216;&#8217;&#8216;</p>
<blockquote>
<div><p>The code begins in file antiweb.py at line 1461:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre>class PythonReader(Reader):
    def __init__(self, lexer):
        super(PythonReader, self).__init__(lexer)
        self.doc_lines = []

    &lt;&lt;PythonReader._post_process&gt;&gt;
    &lt;&lt;PythonReader._accept_token&gt;&gt;
    &lt;&lt;PythonReader._cut_comment&gt;&gt;
    &lt;&lt;PythonReader.filter_output&gt;&gt;
class CSharpReader(Reader):
    def __init__(self, lexer):
        super(CSharpReader, self).__init__(lexer)
        self.doc_lines = []

    &lt;&lt;PythonReader._post_process&gt;&gt;
    &lt;&lt;PythonReader._accept_token&gt;&gt;
    &lt;&lt;PythonReader._cut_comment&gt;&gt;
    &lt;&lt;PythonReader.filter_output&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="method">
<dt id="_post_process">
<code class="descname">_post_process</code><span class="sig-paren">(</span><em>fname</em>, <em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#_post_process" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Reader._post_process" title="Reader._post_process"><code class="xref py py-meth docutils literal"><span class="pre">Reader._post_process()</span></code></a>.</p>
<p>This implementation <em>decorates</em> doc strings
with antiweb directives.</p>
<p>The code begins in file antiweb.py at line 1723:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre>def _post_process(self, fname, text):
    #from behind because we will probably insert some lines
    self.doc_lines.sort(reverse=True)

    #handle each found doc string
    for start_line, end_line in self.doc_lines:
        indents = set()

        &lt;&lt;no antiweb directives in doc string&gt;&gt;
        &lt;&lt;find the last directive before the doc string&gt;&gt;

        if isinstance(last_directive, RStart):
            &lt;&lt;decorate beginning and end&gt;&gt;

            if isinstance(last_directive, CStart):
                &lt;&lt;insert additional include&gt;&gt;

    super(CSharpReader, self)._post_process(fname, text)
</pre></div>
</td></tr></table></div>
<p id="no-antiweb-directives-in-doc-string"><strong>&lt;&lt;no antiweb directives in doc string&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 1740:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#If antiweb directives are within the doc string,</span>
<span class="c">#the doc string will not be decorated!</span>
<span class="n">directives_between_start_and_end_line</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">start_line</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">end_line</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
        <span class="c">#needed for &lt;&lt;insert additional include&gt;&gt;</span>
        <span class="n">indents</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
        <span class="n">directives_between_start_and_end_line</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">break</span>

<span class="k">if</span> <span class="n">directives_between_start_and_end_line</span><span class="p">:</span> <span class="k">continue</span>
</pre></div>
</td></tr></table></div>
<p id="find-the-last-directive-before-the-doc-string"><strong>&lt;&lt;find the last directive before the doc string&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 1755:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">last_directive</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[:</span><span class="n">start_line</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
        <span class="n">last_directive</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">break</span>
</pre></div>
</div>
<p id="decorate-beginning-and-end"><strong>&lt;&lt;decorate beginning and end&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 1764:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">start_line</span><span class="p">]</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">Start</span><span class="p">(</span><span class="n">start_line</span><span class="p">,</span> <span class="n">last_directive</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot; doc&quot;</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>

<span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">end_line</span><span class="p">]</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">end_line</span><span class="p">,</span> <span class="n">last_directive</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot; doc&quot;</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">end</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p id="insert-additional-include"><strong>&lt;&lt;insert additional include&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 1775:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">include</span> <span class="o">=</span> <span class="n">Include</span><span class="p">(</span><span class="n">end_line</span><span class="p">,</span> <span class="n">last_directive</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">include</span><span class="p">]</span>
<span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">end_line</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>

<span class="c">#the include directive should have the same</span>
<span class="c">#indentation as the .. py:function:: directive</span>
<span class="c">#inside the doc string. (It should be second</span>
<span class="c">#value of sorted indents)</span>
<span class="n">indents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">indents</span><span class="p">))</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">l</span><span class="o">.</span><span class="n">change_indent</span><span class="p">(</span><span class="n">indents</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">l</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="_accept_token">
<code class="descname">_accept_token</code><span class="sig-paren">(</span><em>token</em><span class="sig-paren">)</span><a class="headerlink" href="#_accept_token" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Reader._accept_token" title="Reader._accept_token"><code class="xref py py-meth docutils literal"><span class="pre">Reader._accept_token()</span></code></a>.</p>
<p>The code begins in file antiweb.py at line 1798:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_accept_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">Token</span><span class="o">.</span><span class="n">Comment</span> <span class="ow">or</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">Token</span><span class="o">.</span><span class="n">Literal</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Doc</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="filter_output">
<code class="descname">filter_output</code><span class="sig-paren">(</span><em>lines</em><span class="sig-paren">)</span><a class="headerlink" href="#filter_output" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Reader.filter_output" title="Reader.filter_output"><code class="xref py py-meth docutils literal"><span class="pre">Reader.filter_output()</span></code></a>.</p>
<p>The code begins in file antiweb.py at line 1829:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">filter_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s">&quot;d&quot;</span><span class="p">:</span>
            <span class="c">#remove comment chars in document lines</span>
            <span class="n">stext</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">stext</span> <span class="o">==</span> <span class="s">&#39;/*&#39;</span> <span class="ow">or</span> <span class="n">stext</span> <span class="o">==</span> <span class="s">&quot;*/&quot;</span><span class="p">:</span>
                <span class="c">#remove &quot;&quot;&quot; and &#39;&#39;&#39; from documentation lines</span>
                <span class="c">#see the l.text.lstrip()! if the lines ends with a white space</span>
                <span class="c">#the quotes will be kept! This is feature, to force the quotes</span>
                <span class="c">#in the output</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">stext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;//&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">stext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;#####&quot;</span><span class="p">):</span>
                <span class="c">#remove comments but not chapters</span>
                <span class="n">l</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">indented</span><span class="p">(</span><span class="n">stext</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

        <span class="k">yield</span> <span class="n">l</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="_cut_comment">
<code class="descname">_cut_comment</code><span class="sig-paren">(</span><em>index</em>, <em>token</em>, <em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#_cut_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#Reader._cut_comment" title="Reader._cut_comment"><code class="xref py py-meth docutils literal"><span class="pre">Reader._cut_comment()</span></code></a>.</p>
<p>The code begins in file antiweb.py at line 1808:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_cut_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">Token</span><span class="o">.</span><span class="n">Literal</span><span class="o">.</span><span class="n">String</span><span class="o">.</span><span class="n">Doc</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;/*&#39;</span><span class="p">):</span>
            <span class="c">#save the start/end line of doc strings beginning with &quot;&quot;&quot;</span>
            <span class="c">#for further decoration processing in _post_process,</span>
            <span class="n">start_line</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starts</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">end_line</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starts</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()))</span> <span class="c">#filter out empty strings</span>
            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">doc_lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start_line</span><span class="p">,</span> <span class="n">end_line</span><span class="p">))</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">text</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</div></blockquote>
</div>
</div>
<div class="section" id="document">
<h2>Document<a class="headerlink" href="#document" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Document<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Document">
<em class="property">class </em><code class="descname">Document</code><span class="sig-paren">(</span><em>text</em>, <em>reader</em>, <em>fname</em>, <em>tokens</em><span class="sig-paren">)</span><a class="headerlink" href="#Document" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the mediator communicating with all other classes
to generate rst output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>text</strong> (<em>string</em>) &#8211; the source code to parse.</li>
<li><strong>reader</strong> &#8211; An instance of <a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a>.</li>
<li><strong>fname</strong> (<em>string</em>) &#8211; The file name of the source code.</li>
<li><strong>tokens</strong> &#8211; A sequence of tokens usable for the <code class="docutils literal"><span class="pre">&#64;if</span></code> directive.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2113:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772</pre></div></td><td class="code"><div class="highlight"><pre>class Document(object):
    #Attributes


       The code begins in file antiweb.py at line 2113:
       ::

           class Document(object):
               #Attributes

                  #@include(Document)
                  .. py:attribute:: errors

                     A list of errors found during generation.

                     The code begins in file antiweb.py at line 2174:
                     ::

                         errors = []

                  .. py:attribute:: blocks

                     A dictionary of all found blocks: Name -&gt; List of Lines

                     The code begins in file antiweb.py at line 2181:
                     ::

                         blocks = {}

                  .. py:attribute:: blocks_included

                     A set containing all block names that have been included by
                     an @include directive.

                     The code begins in file antiweb.py at line 2188:
                     ::

                         blocks_included = set()

                  .. py:attribute:: compiled_blocks

                     A set containing all block names that have been already
                     compiled.

                     The code begins in file antiweb.py at line 2196:
                     ::

                         compiled_blocks = set()

                  .. py:attribute:: sub_documents

                     A cache dictionary of sub documents, referenced by
                     ``@include`` directives: Filename -&gt; Document

                     The code begins in file antiweb.py at line 2204:
                     ::

                         sub_documents = {}

                  .. py:attribute:: tokens

                     A set of token names that can be used for the ``@if`` directive.

                     The code begins in file antiweb.py at line 2212:
                     ::

                         tokens = set()

                  .. py:attribute:: macros

                     A dictionary containing the macros that can be used
                     by the ``@subst`` directive: Macro name -&gt; substitution.

                     The code begins in file antiweb.py at line 2219:
                     ::

                         macros = {}

                  .. py:attribute:: fname

                     The file name of the document&#39;s source.

                     The code begins in file antiweb.py at line 2227:
                     ::

                         fname = &quot;&quot;

                  .. py:attribute:: reader

                     The instance of a :py:class:`Reader` object.

                     The code begins in file antiweb.py at line 2234:
                     ::

                         reader = None

                  .. py:attribute:: lines

                     A list of :py:class:`Line` objects representing the whole documents
                     split in lines.

                     The code begins in file antiweb.py at line 2241:
                     ::

                         lines = []

                  .. py:method:: __init__(text, reader, fname, tokens)

                     The constructor.

                     The code begins in file antiweb.py at line 2252:
                     ::

                         def __init__(self, text, reader, fname, tokens):
                             self.errors = []
                             self.blocks = {}
                             self.blocks_included = set()
                             self.compiled_blocks = set()
                             self.sub_documents = {}
                             self.tokens = set(tokens or [])
                             self.macros = { &quot;__file__&quot; : os.path.split(fname)[-1],
                                             &quot;__codeprefix__&quot; : &quot;&quot; }
                             self.fname = fname
                             self.reader = reader
                             self.lines = self.reader.process(fname, text)



                  .. py:method:: process(show_warnings)

                     Processes the document and generates the output.

                     :param bool show_warnings: If ``True`` warnings are emitted.
                     :return: A string representing the rst output.

                     The code begins in file antiweb.py at line 2272:
                     ::

                         def process(self, show_warnings):
                             self.collect_blocks()
                             if &quot;&quot; not in self.blocks:
                                 self.add_error(0, &quot;no @start() directive found (I need one)&quot;)
                                 self.check_errors()

                             try:
                                 text = self.get_compiled_block(&quot;&quot;)
                             finally:
                                 self.check_errors()

                             if show_warnings:
                                 &lt;&lt;show warnings&gt;&gt;

                             text = self.reader.filter_output(text)
                             return &quot;\n&quot;.join(map(operator.attrgetter(&quot;text&quot;), text))

                     .. _show warnings:

                     **&lt;&lt;show warnings&gt;&gt;**


                     The code begins in file antiweb.py at line 2293:
                     ::

                         self.blocks_included.add(&quot;&quot;)           #may not cause a warning
                         self.blocks_included.add(&quot;__macros__&quot;) #may not cause a warning
                         unincluded = set(self.blocks.keys())-self.blocks_included
                         if unincluded:
                             logger.warning(&quot;The following blocks were not included:&quot;)
                             warnings = [ (self.blocks[b][0].index, b) for b in unincluded ]
                             warnings.sort(key=operator.itemgetter(0))
                             for l, w in warnings:
                                 logger.warning(&quot;  %s(line %i)&quot;, w, l)


                  .. py:method:: get_subdoc(rpath)

                     Tries to compile a document with the relative path rpath.

                     :param string rpath: The relative path to the root
                                          containing document.
                     :return: A :py:class:`Document` reference to the sub document.

                     The code begins in file antiweb.py at line 2310:
                     ::

                         def get_subdoc(self, rpath):
                             &lt;&lt;return from cache if possible&gt;&gt;
                             &lt;&lt;insert macros function&gt;&gt;
                             &lt;&lt;read the source file&gt;&gt;

                             self.sub_documents[rpath] = doc
                             return doc


                     .. _return from cache if possible:

                     **&lt;&lt;return from cache if possible&gt;&gt;**


                     The code begins in file antiweb.py at line 2321:
                     ::

                         try:
                             return self.sub_documents[rpath]
                         except KeyError:
                             pass



                     .. _insert macros function:

                     **&lt;&lt;insert macros function&gt;&gt;**


                     The code begins in file antiweb.py at line 2327:
                     ::

                         def insert_macros(subdoc):
                             #if sub doc has no macros insert mine
                             if (&quot;__macros__&quot; not in subdoc.blocks
                                 and &quot;__macros__&quot; in self.blocks):
                                 file_ = subdoc.macros[&quot;__file__&quot;] # preserve __file__
                                 subdoc.macros.update(self.macros)
                                 subdoc.macros[&quot;__file__&quot;] = file_



                     .. _read the source file:

                     **&lt;&lt;read the source file&gt;&gt;**


                     The code begins in file antiweb.py at line 2336:
                     ::

                         head, tail = os.path.split(self.fname)
                         fpath = os.path.join(head, rpath)

                         try:
                             #print &quot;try open&quot;, fpath
                             with open(fpath, &quot;r&quot;) as f:
                                 text = f.read()
                         except IOError:
                             doc = None
                             logger.error(&quot;Could not open: %s&quot;, fpath)

                         else:
                             #parse the file
                             lexer = pm.get_lexer_for_filename(rpath)
                             reader = readers.get(lexer.name, Reader)(lexer)
                             doc = Document(text, reader, rpath, self.tokens)
                             doc.collect_blocks()
                             insert_macros(doc)


                  .. py:method:: add_error(line, text)

                     Adds an error to the list.

                     :param integer line: The line number that causes the error.
                     :param string text: An error text.

                     The code begins in file antiweb.py at line 2365:
                     ::

                         def add_error(self, line, text):
                             self.errors.append((self.lines[line], text))



                  .. py:method:: check_errors()

                     Raises a ``WebError`` exception if error were found.

                     The code begins in file antiweb.py at line 2378:
                     ::

                         def check_errors(self):
                             if self.errors:
                                 raise WebError(self.errors)


                  .. py:method:: collect_blocks()

                     Collects all text blocks.

                     The code begins in file antiweb.py at line 2388:
                     ::

                         def collect_blocks(self):
                             blocks = [ d.collect_block(self, i)
                                        for i, l in enumerate(self.lines)
                                        for d in l.directives ]

                             self.blocks = dict(list(filter(bool, blocks)))

                             if &quot;__macros__&quot; in self.blocks:
                                 self.get_compiled_block(&quot;__macros__&quot;)



                  .. py:method:: get_compiled_block(name)

                     Returns the compiled version of a text block.
                     Compiled means: all directives where processed.

                     :param string name: The name of the text block:
                     :return: A list of :py:class:`Line` objects representing
                              the text block.


                     The code begins in file antiweb.py at line 2405:
                     ::

                         def get_compiled_block(self, name):
                             if name not in self.blocks:
                                 return None

                             if name in self.compiled_blocks:
                                 return self.blocks[name]

                             return self.compile_block(name, self.blocks[name])



                  .. py:method:: compile_block(name, block)

                     Compiles a text block.

                     :param string name: The name of the block
                     :param block: A list of :py:class:`Line` objects representing
                                   the text block to compile.
                     :return: A list of :py:class:`Line` objects representing
                              the compiled text block.

                     The code begins in file antiweb.py at line 2427:
                     ::

                         def compile_block(self, name, block):
                             &lt;&lt;find_next_directive&gt;&gt;

                             while True:
                                 directive_index = find_next_directive(block)
                                 if not directive_index: break
                                 directive, index = directive_index
                                 directive.process(self, block, index)

                             self.compiled_blocks.add(name)
                             return block

                     .. _find_next_directive:

                     **&lt;&lt;find_next_directive&gt;&gt;**


                     The code begins in file antiweb.py at line 2440:
                     ::

                         def find_next_directive(block):
                             # returns the next available directive
                             min_line = [ (l.directives[0].priority, i)
                                          for i, l in enumerate(block) if l.directives ]
                             if not min_line:
                                 return None

                             prio, index = min(min_line)
                             return block[index].directives.pop(0), index


                  #Attributes
                  &lt;&lt;Document.errors&gt;&gt;
                  &lt;&lt;Document.blocks&gt;&gt;
                  &lt;&lt;Document.blocks_included&gt;&gt;
                  &lt;&lt;Document.compiled_blocks&gt;&gt;
                  &lt;&lt;Document.sub_documents&gt;&gt;
                  &lt;&lt;Document.tokens&gt;&gt;
                  &lt;&lt;Document.macros&gt;&gt;
                  &lt;&lt;Document.fname&gt;&gt;
                  &lt;&lt;Document.reader&gt;&gt;
                  &lt;&lt;Document.lines&gt;&gt;

                  #Methods
                  &lt;&lt;Document.__init__&gt;&gt;
                  &lt;&lt;Document.process&gt;&gt;
                  &lt;&lt;Document.get_subdoc&gt;&gt;
                  &lt;&lt;Document.add_error&gt;&gt;
                  &lt;&lt;Document.check_errors&gt;&gt;
                  &lt;&lt;Document.collect_blocks&gt;&gt;
                  &lt;&lt;Document.get_compiled_block&gt;&gt;
                  &lt;&lt;Document.compile_block&gt;&gt;



       .. py:attribute:: errors

          A list of errors found during generation.

          The code begins in file antiweb.py at line 2174:
          ::

              errors = []

       .. py:attribute:: blocks

          A dictionary of all found blocks: Name -&gt; List of Lines

          The code begins in file antiweb.py at line 2181:
          ::

              blocks = {}

       .. py:attribute:: blocks_included

          A set containing all block names that have been included by
          an @include directive.

          The code begins in file antiweb.py at line 2188:
          ::

              blocks_included = set()

       .. py:attribute:: compiled_blocks

          A set containing all block names that have been already
          compiled.

          The code begins in file antiweb.py at line 2196:
          ::

              compiled_blocks = set()

       .. py:attribute:: sub_documents

          A cache dictionary of sub documents, referenced by
          ``@include`` directives: Filename -&gt; Document

          The code begins in file antiweb.py at line 2204:
          ::

              sub_documents = {}

       .. py:attribute:: tokens

          A set of token names that can be used for the ``@if`` directive.

          The code begins in file antiweb.py at line 2212:
          ::

              tokens = set()

       .. py:attribute:: macros

          A dictionary containing the macros that can be used
          by the ``@subst`` directive: Macro name -&gt; substitution.

          The code begins in file antiweb.py at line 2219:
          ::

              macros = {}

       .. py:attribute:: fname

          The file name of the document&#39;s source.

          The code begins in file antiweb.py at line 2227:
          ::

              fname = &quot;&quot;

       .. py:attribute:: reader

          The instance of a :py:class:`Reader` object.

          The code begins in file antiweb.py at line 2234:
          ::

              reader = None

       .. py:attribute:: lines

          A list of :py:class:`Line` objects representing the whole documents
          split in lines.

          The code begins in file antiweb.py at line 2241:
          ::

              lines = []

       .. py:method:: __init__(text, reader, fname, tokens)

          The constructor.

          The code begins in file antiweb.py at line 2252:
          ::

              def __init__(self, text, reader, fname, tokens):
                  self.errors = []
                  self.blocks = {}
                  self.blocks_included = set()
                  self.compiled_blocks = set()
                  self.sub_documents = {}
                  self.tokens = set(tokens or [])
                  self.macros = { &quot;__file__&quot; : os.path.split(fname)[-1],
                                  &quot;__codeprefix__&quot; : &quot;&quot; }
                  self.fname = fname
                  self.reader = reader
                  self.lines = self.reader.process(fname, text)



       .. py:method:: process(show_warnings)

          Processes the document and generates the output.

          :param bool show_warnings: If ``True`` warnings are emitted.
          :return: A string representing the rst output.

          The code begins in file antiweb.py at line 2272:
          ::

              def process(self, show_warnings):
                  self.collect_blocks()
                  if &quot;&quot; not in self.blocks:
                      self.add_error(0, &quot;no @start() directive found (I need one)&quot;)
                      self.check_errors()

                  try:
                      text = self.get_compiled_block(&quot;&quot;)
                  finally:
                      self.check_errors()

                  if show_warnings:
                      &lt;&lt;show warnings&gt;&gt;

                  text = self.reader.filter_output(text)
                  return &quot;\n&quot;.join(map(operator.attrgetter(&quot;text&quot;), text))

          .. _show warnings:

          **&lt;&lt;show warnings&gt;&gt;**


          The code begins in file antiweb.py at line 2293:
          ::

              self.blocks_included.add(&quot;&quot;)           #may not cause a warning
              self.blocks_included.add(&quot;__macros__&quot;) #may not cause a warning
              unincluded = set(self.blocks.keys())-self.blocks_included
              if unincluded:
                  logger.warning(&quot;The following blocks were not included:&quot;)
                  warnings = [ (self.blocks[b][0].index, b) for b in unincluded ]
                  warnings.sort(key=operator.itemgetter(0))
                  for l, w in warnings:
                      logger.warning(&quot;  %s(line %i)&quot;, w, l)


       .. py:method:: get_subdoc(rpath)

          Tries to compile a document with the relative path rpath.

          :param string rpath: The relative path to the root
                               containing document.
          :return: A :py:class:`Document` reference to the sub document.

          The code begins in file antiweb.py at line 2310:
          ::

              def get_subdoc(self, rpath):
                  &lt;&lt;return from cache if possible&gt;&gt;
                  &lt;&lt;insert macros function&gt;&gt;
                  &lt;&lt;read the source file&gt;&gt;

                  self.sub_documents[rpath] = doc
                  return doc


          .. _return from cache if possible:

          **&lt;&lt;return from cache if possible&gt;&gt;**


          The code begins in file antiweb.py at line 2321:
          ::

              try:
                  return self.sub_documents[rpath]
              except KeyError:
                  pass



          .. _insert macros function:

          **&lt;&lt;insert macros function&gt;&gt;**


          The code begins in file antiweb.py at line 2327:
          ::

              def insert_macros(subdoc):
                  #if sub doc has no macros insert mine
                  if (&quot;__macros__&quot; not in subdoc.blocks
                      and &quot;__macros__&quot; in self.blocks):
                      file_ = subdoc.macros[&quot;__file__&quot;] # preserve __file__
                      subdoc.macros.update(self.macros)
                      subdoc.macros[&quot;__file__&quot;] = file_



          .. _read the source file:

          **&lt;&lt;read the source file&gt;&gt;**


          The code begins in file antiweb.py at line 2336:
          ::

              head, tail = os.path.split(self.fname)
              fpath = os.path.join(head, rpath)

              try:
                  #print &quot;try open&quot;, fpath
                  with open(fpath, &quot;r&quot;) as f:
                      text = f.read()
              except IOError:
                  doc = None
                  logger.error(&quot;Could not open: %s&quot;, fpath)

              else:
                  #parse the file
                  lexer = pm.get_lexer_for_filename(rpath)
                  reader = readers.get(lexer.name, Reader)(lexer)
                  doc = Document(text, reader, rpath, self.tokens)
                  doc.collect_blocks()
                  insert_macros(doc)


       .. py:method:: add_error(line, text)

          Adds an error to the list.

          :param integer line: The line number that causes the error.
          :param string text: An error text.

          The code begins in file antiweb.py at line 2365:
          ::

              def add_error(self, line, text):
                  self.errors.append((self.lines[line], text))



       .. py:method:: check_errors()

          Raises a ``WebError`` exception if error were found.

          The code begins in file antiweb.py at line 2378:
          ::

              def check_errors(self):
                  if self.errors:
                      raise WebError(self.errors)


       .. py:method:: collect_blocks()

          Collects all text blocks.

          The code begins in file antiweb.py at line 2388:
          ::

              def collect_blocks(self):
                  blocks = [ d.collect_block(self, i)
                             for i, l in enumerate(self.lines)
                             for d in l.directives ]

                  self.blocks = dict(list(filter(bool, blocks)))

                  if &quot;__macros__&quot; in self.blocks:
                      self.get_compiled_block(&quot;__macros__&quot;)



       .. py:method:: get_compiled_block(name)

          Returns the compiled version of a text block.
          Compiled means: all directives where processed.

          :param string name: The name of the text block:
          :return: A list of :py:class:`Line` objects representing
                   the text block.


          The code begins in file antiweb.py at line 2405:
          ::

              def get_compiled_block(self, name):
                  if name not in self.blocks:
                      return None

                  if name in self.compiled_blocks:
                      return self.blocks[name]

                  return self.compile_block(name, self.blocks[name])



       .. py:method:: compile_block(name, block)

          Compiles a text block.

          :param string name: The name of the block
          :param block: A list of :py:class:`Line` objects representing
                        the text block to compile.
          :return: A list of :py:class:`Line` objects representing
                   the compiled text block.

          The code begins in file antiweb.py at line 2427:
          ::

              def compile_block(self, name, block):
                  &lt;&lt;find_next_directive&gt;&gt;

                  while True:
                      directive_index = find_next_directive(block)
                      if not directive_index: break
                      directive, index = directive_index
                      directive.process(self, block, index)

                  self.compiled_blocks.add(name)
                  return block

          .. _find_next_directive:

          **&lt;&lt;find_next_directive&gt;&gt;**


          The code begins in file antiweb.py at line 2440:
          ::

              def find_next_directive(block):
                  # returns the next available directive
                  min_line = [ (l.directives[0].priority, i)
                               for i, l in enumerate(block) if l.directives ]
                  if not min_line:
                      return None

                  prio, index = min(min_line)
                  return block[index].directives.pop(0), index


       #Attributes
       &lt;&lt;Document.errors&gt;&gt;
       &lt;&lt;Document.blocks&gt;&gt;
       &lt;&lt;Document.blocks_included&gt;&gt;
       &lt;&lt;Document.compiled_blocks&gt;&gt;
       &lt;&lt;Document.sub_documents&gt;&gt;
       &lt;&lt;Document.tokens&gt;&gt;
       &lt;&lt;Document.macros&gt;&gt;
       &lt;&lt;Document.fname&gt;&gt;
       &lt;&lt;Document.reader&gt;&gt;
       &lt;&lt;Document.lines&gt;&gt;

       #Methods
       &lt;&lt;Document.__init__&gt;&gt;
       &lt;&lt;Document.process&gt;&gt;
       &lt;&lt;Document.get_subdoc&gt;&gt;
       &lt;&lt;Document.add_error&gt;&gt;
       &lt;&lt;Document.check_errors&gt;&gt;
       &lt;&lt;Document.collect_blocks&gt;&gt;
       &lt;&lt;Document.get_compiled_block&gt;&gt;
       &lt;&lt;Document.compile_block&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="attribute">
<dt id="Document.errors">
<code class="descname">errors</code><a class="headerlink" href="#Document.errors" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of errors found during generation.</p>
<p>The code begins in file antiweb.py at line 2174:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.blocks">
<code class="descname">blocks</code><a class="headerlink" href="#Document.blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of all found blocks: Name -&gt; List of Lines</p>
<p>The code begins in file antiweb.py at line 2181:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">blocks</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.blocks_included">
<code class="descname">blocks_included</code><a class="headerlink" href="#Document.blocks_included" title="Permalink to this definition">¶</a></dt>
<dd><p>A set containing all block names that have been included by
an &#64;include directive.</p>
<p>The code begins in file antiweb.py at line 2188:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">blocks_included</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.compiled_blocks">
<code class="descname">compiled_blocks</code><a class="headerlink" href="#Document.compiled_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>A set containing all block names that have been already
compiled.</p>
<p>The code begins in file antiweb.py at line 2196:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">compiled_blocks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.sub_documents">
<code class="descname">sub_documents</code><a class="headerlink" href="#Document.sub_documents" title="Permalink to this definition">¶</a></dt>
<dd><p>A cache dictionary of sub documents, referenced by
<code class="docutils literal"><span class="pre">&#64;include</span></code> directives: Filename -&gt; Document</p>
<p>The code begins in file antiweb.py at line 2204:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sub_documents</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.tokens">
<code class="descname">tokens</code><a class="headerlink" href="#Document.tokens" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of token names that can be used for the <code class="docutils literal"><span class="pre">&#64;if</span></code> directive.</p>
<p>The code begins in file antiweb.py at line 2212:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.macros">
<code class="descname">macros</code><a class="headerlink" href="#Document.macros" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary containing the macros that can be used
by the <code class="docutils literal"><span class="pre">&#64;subst</span></code> directive: Macro name -&gt; substitution.</p>
<p>The code begins in file antiweb.py at line 2219:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">macros</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.fname">
<code class="descname">fname</code><a class="headerlink" href="#Document.fname" title="Permalink to this definition">¶</a></dt>
<dd><p>The file name of the document&#8217;s source.</p>
<p>The code begins in file antiweb.py at line 2227:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fname</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.reader">
<code class="descname">reader</code><a class="headerlink" href="#Document.reader" title="Permalink to this definition">¶</a></dt>
<dd><p>The instance of a <a class="reference internal" href="#Reader" title="Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a> object.</p>
<p>The code begins in file antiweb.py at line 2234:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reader</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Document.lines">
<code class="descname">lines</code><a class="headerlink" href="#Document.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> objects representing the whole documents
split in lines.</p>
<p>The code begins in file antiweb.py at line 2241:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Document.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>text</em>, <em>reader</em>, <em>fname</em>, <em>tokens</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor.</p>
<p>The code begins in file antiweb.py at line 2252:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">tokens</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocks_included</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">compiled_blocks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sub_documents</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tokens</span> <span class="ow">or</span> <span class="p">[])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">macros</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;__file__&quot;</span> <span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s">&quot;__codeprefix__&quot;</span> <span class="p">:</span> <span class="s">&quot;&quot;</span> <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Document.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>show_warnings</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Processes the document and generates the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>show_warnings</strong> (<em>bool</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code> warnings are emitted.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A string representing the rst output.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2272:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre>def process(self, show_warnings):
    self.collect_blocks()
    if &quot;&quot; not in self.blocks:
        self.add_error(0, &quot;no @start() directive found (I need one)&quot;)
        self.check_errors()

    try:
        text = self.get_compiled_block(&quot;&quot;)
    finally:
        self.check_errors()

    if show_warnings:
        &lt;&lt;show warnings&gt;&gt;

    text = self.reader.filter_output(text)
    return &quot;\n&quot;.join(map(operator.attrgetter(&quot;text&quot;), text))
</pre></div>
</td></tr></table></div>
<p id="show-warnings"><strong>&lt;&lt;show warnings&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 2293:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">blocks_included</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>           <span class="c">#may not cause a warning</span>
<span class="bp">self</span><span class="o">.</span><span class="n">blocks_included</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;__macros__&quot;</span><span class="p">)</span> <span class="c">#may not cause a warning</span>
<span class="n">unincluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks_included</span>
<span class="k">if</span> <span class="n">unincluded</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;The following blocks were not included:&quot;</span><span class="p">)</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">unincluded</span> <span class="p">]</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%s</span><span class="s">(line </span><span class="si">%i</span><span class="s">)&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Document.get_subdoc">
<code class="descname">get_subdoc</code><span class="sig-paren">(</span><em>rpath</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_subdoc" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to compile a document with the relative path rpath.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rpath</strong> (<em>string</em>) &#8211; The relative path to the root
containing document.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="#Document" title="Document"><code class="xref py py-class docutils literal"><span class="pre">Document</span></code></a> reference to the sub document.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2310:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre>def get_subdoc(self, rpath):
    &lt;&lt;return from cache if possible&gt;&gt;
    &lt;&lt;insert macros function&gt;&gt;
    &lt;&lt;read the source file&gt;&gt;

    self.sub_documents[rpath] = doc
    return doc
</pre></div>
</td></tr></table></div>
<p id="return-from-cache-if-possible"><strong>&lt;&lt;return from cache if possible&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 2321:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_documents</span><span class="p">[</span><span class="n">rpath</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p id="insert-macros-function"><strong>&lt;&lt;insert macros function&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 2327:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">insert_macros</span><span class="p">(</span><span class="n">subdoc</span><span class="p">):</span>
    <span class="c">#if sub doc has no macros insert mine</span>
    <span class="k">if</span> <span class="p">(</span><span class="s">&quot;__macros__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subdoc</span><span class="o">.</span><span class="n">blocks</span>
        <span class="ow">and</span> <span class="s">&quot;__macros__&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">):</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="n">subdoc</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s">&quot;__file__&quot;</span><span class="p">]</span> <span class="c"># preserve __file__</span>
        <span class="n">subdoc</span><span class="o">.</span><span class="n">macros</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macros</span><span class="p">)</span>
        <span class="n">subdoc</span><span class="o">.</span><span class="n">macros</span><span class="p">[</span><span class="s">&quot;__file__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_</span>
</pre></div>
</td></tr></table></div>
<p id="read-the-source-file"><strong>&lt;&lt;read the source file&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 2336:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">)</span>
<span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">rpath</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c">#print &quot;try open&quot;, fpath</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Could not open: </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fpath</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="c">#parse the file</span>
    <span class="n">lexer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_lexer_for_filename</span><span class="p">(</span><span class="n">rpath</span><span class="p">)</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">readers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">lexer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Reader</span><span class="p">)(</span><span class="n">lexer</span><span class="p">)</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">rpath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">collect_blocks</span><span class="p">()</span>
    <span class="n">insert_macros</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Document.add_error">
<code class="descname">add_error</code><span class="sig-paren">(</span><em>line</em>, <em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an error to the list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line</strong> (<em>integer</em>) &#8211; The line number that causes the error.</li>
<li><strong>text</strong> (<em>string</em>) &#8211; An error text.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2365:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">add_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">line</span><span class="p">],</span> <span class="n">text</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Document.check_errors">
<code class="descname">check_errors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.check_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises a <code class="docutils literal"><span class="pre">WebError</span></code> exception if error were found.</p>
<p>The code begins in file antiweb.py at line 2378:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">check_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">WebError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Document.collect_blocks">
<code class="descname">collect_blocks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.collect_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects all text blocks.</p>
<p>The code begins in file antiweb.py at line 2388:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">collect_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span> <span class="n">d</span><span class="o">.</span><span class="n">collect_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span> <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">blocks</span><span class="p">)))</span>

    <span class="k">if</span> <span class="s">&quot;__macros__&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_compiled_block</span><span class="p">(</span><span class="s">&quot;__macros__&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Document.get_compiled_block">
<code class="descname">get_compiled_block</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_compiled_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the compiled version of a text block.
Compiled means: all directives where processed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>string</em>) &#8211; The name of the text block:</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list of <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> objects representing
the text block.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2405:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_compiled_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled_blocks</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compile_block</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Document.compile_block">
<code class="descname">compile_block</code><span class="sig-paren">(</span><em>name</em>, <em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#Document.compile_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles a text block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>string</em>) &#8211; The name of the block</li>
<li><strong>block</strong> &#8211; A list of <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> objects representing
the text block to compile.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> objects representing
the compiled text block.</p>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 2427:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre>def compile_block(self, name, block):
    &lt;&lt;find_next_directive&gt;&gt;

    while True:
        directive_index = find_next_directive(block)
        if not directive_index: break
        directive, index = directive_index
        directive.process(self, block, index)

    self.compiled_blocks.add(name)
    return block
</pre></div>
</td></tr></table></div>
<p id="find-next-directive"><strong>&lt;&lt;find_next_directive&gt;&gt;</strong></p>
<p>The code begins in file antiweb.py at line 2440:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">find_next_directive</span><span class="p">(</span><span class="n">block</span><span class="p">):</span>
    <span class="c"># returns the next available directive</span>
    <span class="n">min_line</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">directives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">directives</span> <span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">min_line</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">prio</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_line</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">block</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">directives</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">index</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="line">
<h3>Line<a class="headerlink" href="#line" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="Line">
<em class="property">class </em><code class="descname">Line</code><span class="sig-paren">(</span><em>fname</em>, <em>index</em>, <em>text</em><span class="optional">[</span>, <em>directives</em><span class="optional">[</span>, <em>type</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Line" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents a text line.</p>
<p>The code begins in file antiweb.py at line 1874:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre>class Line(object):
    #Attributes
    &lt;&lt;Line._directives&gt;&gt;
    &lt;&lt;Line.fname&gt;&gt;
    &lt;&lt;Line.index&gt;&gt;
    &lt;&lt;Line.text&gt;&gt;
    &lt;&lt;Line.type&gt;&gt;

    #Methods
    &lt;&lt;Line.__init__&gt;&gt;
    &lt;&lt;Line.set&gt;&gt;
    &lt;&lt;Line.clone&gt;&gt;
    &lt;&lt;Line.like&gt;&gt;
    &lt;&lt;Line.indented&gt;&gt;
    &lt;&lt;Line.change_indent&gt;&gt;
    &lt;&lt;Line.__len__&gt;&gt;
    &lt;&lt;Line.__repr__&gt;&gt;

    #Properties
    &lt;&lt;Line.indent&gt;&gt;
    &lt;&lt;Line.sindent&gt;&gt;
    &lt;&lt;Line.directives&gt;&gt;
    &lt;&lt;Line.directive&gt;&gt;
</pre></div>
</td></tr></table></div>
<dl class="attribute">
<dt id="Line._directives">
<code class="descname">_directives</code><a class="headerlink" href="#Line._directives" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of <a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a> objects, sorted
by their priority.</p>
<p>The code begins in file antiweb.py at line 1905:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">_directives</span> <span class="o">=</span> <span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Line.fname">
<code class="descname">fname</code><a class="headerlink" href="#Line.fname" title="Permalink to this definition">¶</a></dt>
<dd><p>A string of the source&#8217;s file name the line belongs to.</p>
<p>The code begins in file antiweb.py at line 1913:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fname</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Line.index">
<code class="descname">index</code><a class="headerlink" href="#Line.index" title="Permalink to this definition">¶</a></dt>
<dd><p>The integer line index of the directive within the current block.</p>
<p>The code begins in file antiweb.py at line 1920:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Line.text">
<code class="descname">text</code><a class="headerlink" href="#Line.text" title="Permalink to this definition">¶</a></dt>
<dd><p>A string containing the source line.</p>
<p>The code begins in file antiweb.py at line 1927:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Line.type">
<code class="descname">type</code><a class="headerlink" href="#Line.type" title="Permalink to this definition">¶</a></dt>
<dd><p>A char representing the line type:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">d</span></code> stands for a document line</li>
<li><code class="docutils literal"><span class="pre">c</span></code> stands for a code line</li>
</ul>
</div></blockquote>
<p>The code begins in file antiweb.py at line 1934:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">type</span> <span class="o">=</span> <span class="s">&quot;d&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="Line.indent">
<code class="descname">indent</code><a class="headerlink" href="#Line.indent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An integer representing the line&#8217;s indentation.</p>
<p>The code begins in file antiweb.py at line 2062:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">indent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="Line.sindent">
<code class="descname">sindent</code><a class="headerlink" href="#Line.sindent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A string representation of the line&#8217;s indentation.</p>
<p>The code begins in file antiweb.py at line 2073:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">sindent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot; &quot;</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">indent</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="Line.directives">
<code class="descname">directives</code><a class="headerlink" href="#Line.directives" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A sorted sequence of <a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a> objects.</p>
<p>The code begins in file antiweb.py at line 2084:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">directives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directives</span>


<span class="nd">@directives.setter</span>
<span class="k">def</span> <span class="nf">directives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_directives</span> <span class="o">=</span> <span class="n">value</span><span class="p">[:]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directives</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directives</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&quot;priority&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<dl class="attribute">
<dt id="Line.directive">
<code class="descname">directive</code><a class="headerlink" href="#Line.directive" title="Permalink to this definition">¶</a></dt>
<dd><p>The first of the contained <a class="reference internal" href="#Directive" title="Directive"><code class="xref py py-class docutils literal"><span class="pre">Directive</span></code></a> objects.</p>
<p>The code begins in file antiweb.py at line 2102:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@property</span>
<span class="k">def</span> <span class="nf">directive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">directives</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">directives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Line.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>index</em>, <em>text</em><span class="optional">[</span>, <em>directives</em><span class="optional">[</span>, <em>type</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Line.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor.</p>
<p>The code begins in file antiweb.py at line 1947:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">directives</span><span class="o">=</span><span class="p">(),</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="n">directives</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Line.set">
<code class="descname">set</code><span class="sig-paren">(</span><span class="optional">[</span><em>index=None</em><span class="optional">[</span>, <em>type=None</em><span class="optional">[</span>, <em>directives=None</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Line.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the attributes <a class="reference internal" href="#Line.index" title="Line.index"><code class="xref py py-attr docutils literal"><span class="pre">index</span></code></a>, <a class="reference internal" href="#Line.type" title="Line.type"><code class="xref py py-attr docutils literal"><span class="pre">type</span></code></a>
and <a class="reference internal" href="#Line.directives" title="Line.directives"><code class="xref py py-attr docutils literal"><span class="pre">directives</span></code></a> at once.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>index</strong> (<em>integer</em>) &#8211; the line index.</li>
<li><strong>type</strong> (<em>char</em>) &#8211; Either <code class="docutils literal"><span class="pre">'d'</span></code> or <code class="docutils literal"><span class="pre">'c'</span></code>.</li>
<li><strong>directives</strong> (<em>list</em>) &#8211; A list of <code class="xref py py-class docutils literal"><span class="pre">DCirective</span></code> objects.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The <a class="reference internal" href="#Line" title="Line"><code class="xref py py-class docutils literal"><span class="pre">Line</span></code></a> object <code class="docutils literal"><span class="pre">self</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1961:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">directives</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>

    <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>

    <span class="k">if</span> <span class="n">directives</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directives</span> <span class="o">=</span> <span class="n">directives</span>

    <span class="k">return</span> <span class="bp">self</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Line.clone">
<code class="descname">clone</code><span class="sig-paren">(</span><span class="optional">[</span><em>dline</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Line.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clones the Line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dline</strong> &#8211; If given replaces the line numbers of all directiveswith the given line number.</td>
</tr>
</tbody>
</table>
<p>The code begins in file antiweb.py at line 1986:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dline</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">dline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directives</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">dline</span>

    <span class="k">return</span> <span class="n">Line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directives</span><span class="p">[:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Line.like">
<code class="descname">like</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#Line.like" title="Permalink to this definition">¶</a></dt>
<dd><p>Clones the Line with a different text.</p>
<p>The code begins in file antiweb.py at line 2006:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indented</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Line.indented">
<code class="descname">indented</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="headerlink" href="#Line.indented" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the text, with the same indentation as <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>The code begins in file antiweb.py at line 2016:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">indented</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sindent</span> <span class="o">+</span> <span class="n">text</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Line.change_indent">
<code class="descname">change_indent</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="headerlink" href="#Line.change_indent" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the lines indentation.</p>
<p>The code begins in file antiweb.py at line 2025:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">change_indent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">delta</span><span class="p">:]</span>

    <span class="k">elif</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>

    <span class="k">return</span> <span class="bp">self</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="method">
<dt id="Line.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Line.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the length of the stripped <a class="reference internal" href="#Line.text" title="Line.text"><code class="xref py py-attr docutils literal"><span class="pre">text</span></code></a>.</p>
<p>The code begins in file antiweb.py at line 2041:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Line.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Line.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a textual representation of the line.</p>
<p>The code begins in file antiweb.py at line 2051:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;Line(</span><span class="si">%i</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directives</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="file-layout">
<h2>File Layout<a class="headerlink" href="#file-layout" title="Permalink to this headline">¶</a></h2>
<p>The code begins in file antiweb.py at line 278:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre>&lt;&lt;imports&gt;&gt;
&lt;&lt;management&gt;&gt;
&lt;&lt;directives&gt;&gt;
&lt;&lt;readers&gt;&gt;
&lt;&lt;document&gt;&gt;
&lt;&lt;command line&gt;&gt;
</pre></div>
</td></tr></table></div>
<p>&#8216;&#8217;&#8217;
&lt;&lt;imports&gt;&gt;
===========
&#8216;&#8217;&#8216;</p>
<p>The code begins in file antiweb.py at line 285:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="kn">import</span> <span class="nn">pygments.lexers</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">from</span> <span class="nn">pygments.token</span> <span class="kn">import</span> <span class="n">Token</span>
<span class="kn">import</span> <span class="nn">bisect</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">operator</span>
</pre></div>
</td></tr></table></div>
<p>&#8216;&#8217;&#8217;
&lt;&lt;management&gt;&gt;
==============
&#8216;&#8217;&#8216;</p>
<p>The code begins in file antiweb.py at line 301:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">__version__</span> <span class="o">=</span> <span class="s">&quot;0.2.2&quot;</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;antiweb&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">WebError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_list</span> <span class="o">=</span> <span class="n">error_list</span>
</pre></div>
</td></tr></table></div>
<p>&#8216;&#8217;&#8217;
&lt;&lt;directives&gt;&gt;
==============</p>
<p>&#8216;&#8217;&#8216;</p>
<p>The code begins in file antiweb.py at line 317:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre>&lt;&lt;Directive&gt;&gt;
&lt;&lt;NameDirective&gt;&gt;
&lt;&lt;Start&gt;&gt;
&lt;&lt;RStart&gt;&gt;
&lt;&lt;CStart&gt;&gt;
&lt;&lt;End&gt;&gt;
&lt;&lt;Fi&gt;&gt;
&lt;&lt;If&gt;&gt;
&lt;&lt;Define&gt;&gt;
&lt;&lt;Enifed&gt;&gt;
&lt;&lt;Subst&gt;&gt;
&lt;&lt;Include&gt;&gt;
&lt;&lt;RInclude&gt;&gt;
&lt;&lt;Edoc&gt;&gt;
&lt;&lt;Code&gt;&gt;
&lt;&lt;Ignore&gt;&gt;
&lt;&lt;Indent&gt;&gt;

directives = {
    &quot;start&quot; : Start,
    &quot;rstart&quot; : RStart,
    &quot;cstart&quot; : CStart,
    &quot;edoc&quot; : Edoc,
    &quot;end&quot; : End,
    &quot;include&quot; : Include,
    &quot;code&quot; : Code,
    &quot;ignore&quot; : Ignore,
    &quot;indent&quot; : Indent,
    &quot;if&quot; : If,
    &quot;fi&quot; : Fi,
    &quot;define&quot; : Define,
    &quot;enifed&quot; : Enifed,
    &quot;subst&quot; : Subst,
    &quot;rinclude&quot; : RInclude,
    }
</pre></div>
</td></tr></table></div>
<p>&#8216;&#8217;&#8217;
&lt;&lt;readers&gt;&gt;
===========
&#8216;&#8217;&#8216;</p>
<p>The code begins in file antiweb.py at line 1262:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre>&lt;&lt;Reader&gt;&gt;
&lt;&lt;CReader&gt;&gt;
&lt;&lt;PythonReader&gt;&gt;
# The keys are the lexer names of pygments
readers = {
    &quot;C&quot; : CReader,
    &quot;C++&quot; : CReader,
        &quot;C#&quot; : CReader,
    &quot;Python&quot; : PythonReader,
}
</pre></div>
</td></tr></table></div>
<p>&#8216;&#8217;&#8217;
&lt;&lt;document&gt;&gt;
============
&#8216;&#8217;&#8216;</p>
<p>The code begins in file antiweb.py at line 1898:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;&lt;Line&gt;&gt;
&lt;&lt;Document&gt;&gt;
&lt;&lt;generate&gt;&gt;
</pre></div>
</div>
<div class="section" id="command-line">
<h3>&lt;&lt;command line&gt;&gt;<a class="headerlink" href="#command-line" title="Permalink to this headline">¶</a></h3>
<p>The code begins in file antiweb.py at line 2557:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="s">&quot;usage: %prog [options] SOURCEFILE&quot;</span><span class="p">,</span>
                          <span class="n">description</span><span class="o">=</span><span class="s">&quot;Tangles a source code file to a rst file.&quot;</span><span class="p">,</span>
                          <span class="n">version</span><span class="o">=</span><span class="s">&quot;%prog &quot;</span> <span class="o">+</span> <span class="n">__version__</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-o&quot;</span><span class="p">,</span> <span class="s">&quot;--output&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;output&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                      <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;The output filename&quot;</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-t&quot;</span><span class="p">,</span> <span class="s">&quot;--token&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;token&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&quot;append&quot;</span><span class="p">,</span>
                      <span class="nb">type</span><span class="o">=</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;defines a token, usable by @if directives&quot;</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-w&quot;</span><span class="p">,</span> <span class="s">&quot;--warnings&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;warnings&quot;</span><span class="p">,</span>
                      <span class="n">action</span><span class="o">=</span><span class="s">&quot;store_false&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;suppresses warnings&quot;</span><span class="p">)</span>

    <span class="n">options</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">())</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">warnings</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">warnings</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">options</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;.rst&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generate</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">warnings</span><span class="p">))</span>

    <span class="k">except</span> <span class="n">WebError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Errors:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">error_list</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;  in line </span><span class="si">%i</span><span class="s">(</span><span class="si">%s</span><span class="s">): </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">fname</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;      </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>



<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="how-to-add-new-languages">
<h2>How to add new languages<a class="headerlink" href="#how-to-add-new-languages" title="Permalink to this headline">¶</a></h2>
<p>New languages are added by writing a new Reader class
and registering it in the readers dictionary (see readers).
A simple Reader example is provides by <a class="reference internal" href="#CReader" title="CReader"><code class="xref py py-class docutils literal"><span class="pre">CReader</span></code></a>
a more advances reader is <code class="xref py py-class docutils literal"><span class="pre">PythonReader</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">antiweb</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#preparing-the-rst-files">Preparing the .rst files</a><ul>
<li><a class="reference internal" href="#antiweb-documentation">Antiweb documentation</a></li>
<li><a class="reference internal" href="#objects">Objects</a></li>
<li><a class="reference internal" href="#directives">Directives</a><ul>
<li><a class="reference internal" href="#directive">Directive</a></li>
<li><a class="reference internal" href="#namedirective">NameDirective</a></li>
<li><a class="reference internal" href="#start">Start</a></li>
<li><a class="reference internal" href="#rstart">RStart</a></li>
<li><a class="reference internal" href="#cstart">CStart</a></li>
<li><a class="reference internal" href="#end">End</a></li>
<li><a class="reference internal" href="#include">Include</a></li>
<li><a class="reference internal" href="#rinclude">RInclude</a></li>
<li><a class="reference internal" href="#code">Code</a></li>
<li><a class="reference internal" href="#edoc">Edoc</a></li>
<li><a class="reference internal" href="#if">If</a></li>
<li><a class="reference internal" href="#fi">Fi</a></li>
<li><a class="reference internal" href="#ignore">Ignore</a></li>
<li><a class="reference internal" href="#define">Define</a></li>
<li><a class="reference internal" href="#enifed">Enifed</a></li>
<li><a class="reference internal" href="#subst">Subst</a></li>
<li><a class="reference internal" href="#indent">Indent</a></li>
</ul>
</li>
<li><a class="reference internal" href="#readers">Readers</a><ul>
<li><a class="reference internal" href="#reader">Reader</a></li>
<li><a class="reference internal" href="#creader">CReader</a></li>
<li><a class="reference internal" href="#pythonreader">PythonReader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#document">Document</a><ul>
<li><a class="reference internal" href="#id2">Document</a></li>
<li><a class="reference internal" href="#line">Line</a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-layout">File Layout</a><ul>
<li><a class="reference internal" href="#command-line">&lt;&lt;command line&gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-add-new-languages">How to add new languages</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Finale_sphinx&#8217;s documentation!</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/antiweb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Phil.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/antiweb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>